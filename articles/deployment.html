<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>6. Deployment • surveydown</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="6. Deployment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveydown</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Usage Guide

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quick_start.html">1. Quick Start</a>
    </li>
    <li>
      <a href="../articles/installation.html">2. Installation</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">3. Editing Survey</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/overview.html">3.1 Overview</a>
        </li>
        <li>
          <a href="../articles/question_types.html">3.2 Question Types</a>
        </li>
        <li>
          <a href="../articles/question_formatting.html">3.3 Question Formatting</a>
        </li>
      </ul>
</li>
    <li>
      <a href="../articles/control_logic.html">4. Control Logic</a>
    </li>
    <li>
      <a href="../articles/database_setup.html">5. Database Setup</a>
    </li>
    <li>
      <a href="../articles/deployment.html">6. Deployment</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jhelvy/surveydown/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>6. Deployment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jhelvy/surveydown/blob/main/vignettes/deployment.Rmd" class="external-link"><code>vignettes/deployment.Rmd</code></a></small>
      <div class="hidden name"><code>deployment.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Great! Now you are ready for online deployment. The purpose of the
deployment is to have your survey available online so that you can
distribute to your desired audiences and collect their responses
efficiently.</p>
<p>In order to deploy your survey, you’ll need to have the following
recipes ready:</p>
<ol style="list-style-type: decimal">
<li>Your survey project made by Quarto that is properly rendered
locally.</li>
<li>Your supabase project with its credentials defined in your survey
<code>.qmd</code> file. See <a href="../articles/database_setup.html">5.
Database Setup</a> for details.</li>
<li>An account on <a href="https://www.shinyapps.io" class="external-link">shinyapps</a>,
which will be used for survey online deployment.</li>
</ol>
<p>These steps are easy to follow. We will go through one by one.</p>
</div>
<div class="section level2">
<h2 id="demo-survey">Demo Survey<a class="anchor" aria-label="anchor" href="#demo-survey"></a>
</h2>
<p>If you have trouble constructing your own survey, we have prepared a
demo survey:</p>
<ol style="list-style-type: decimal">
<li><a href="https://pingfan.shinyapps.io/demo/" class="external-link">Online demo
survey</a></li>
<li><a href="https://github.com/jhelvy/surveydown_demo" class="external-link">GitHub
repository</a></li>
</ol>
<p>This survey was made on <a href="https://posit.co/products/open-source/rstudio/" class="external-link">RStudio</a> using
the {surveydown} R package and the surveydown Quarto extension, with
survey data stored on <a href="https://supabase.com" class="external-link">supabase</a>, and
its online website deployed on <a href="https://www.shinyapps.io" class="external-link">shinyapps</a>.</p>
</div>
<div class="section level2">
<h2 id="step-1-survey-project">Step 1: Survey Project<a class="anchor" aria-label="anchor" href="#step-1-survey-project"></a>
</h2>
<div class="section level3">
<h3 id="step-1-1-construct-your-survey">Step 1-1: Construct your survey<a class="anchor" aria-label="anchor" href="#step-1-1-construct-your-survey"></a>
</h3>
<p>Pick an IDE that is compatible with R and Quarto (<a href="https://posit.co/products/open-source/rstudio/" class="external-link">RStudio</a>, <a href="https://code.visualstudio.com" class="external-link">VS Code</a>, <a href="https://www.cursor.com" class="external-link">Cursor</a>, etc.), and construct your
survey using the {surveydown} R package and the surveydown Quarto
extension.</p>
<p>The previous articles in <strong>Usage Guide</strong> are sufficient
to guide you through the survey construction process.</p>
</div>
<div class="section level3">
<h3 id="step-1-2-set-your-password">Step 1-2: Set your password<a class="anchor" aria-label="anchor" href="#step-1-2-set-your-password"></a>
</h3>
<p>One important setting is the <strong>password</strong> of your
supabase project. Here’s how.</p>
<p>While you set up your supabase project, you will create a password
for it. This password will then be defined in your survey project. In
the very end of your survey <code>.qmd</code> file, you’ll need to
define the <code>db</code> variable, which should be the settings of
your supabase project. There is an argument called
<code>password</code>. You can directly paste your password here as
<code>password = "my_password"</code>, but it’s not recommended since
this will make your supabase project unsafe.</p>
<p>We recommend you to write
<code>password = Sys.getenv("SUPABASE_PASSWORD")</code>, like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sd_database.html">sd_database</a></span><span class="op">(</span></span>
<span>  <span class="co"># Other settings...</span></span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"SUPABASE_PASSWORD"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, define the password using the <code><a href="../reference/sd_set_password.html">sd_set_password()</a></code>
function. For example, if your password is <code>my_password</code>, you
should run <code>sd_set_password("my_password")</code> in the R
Console.</p>
<p>Great! Now you have your supabase password successfully defined in
your survey project!</p>
<p>If you are interested, below are the details of what
<code><a href="../reference/sd_set_password.html">sd_set_password()</a></code> does:</p>
<ol style="list-style-type: decimal">
<li>It creates an <code>.Renviron</code> file or writes into an existing
one.</li>
<li>In this <code>.Renviron</code> file, it writes in
<code>SUPABASE_PASSWORD=my_password</code>, where
<code>"my_password"</code> is whatever your argument of the
<code><a href="../reference/sd_set_password.html">sd_set_password()</a></code> function.</li>
<li>If there is a previously defined <code>SUPABASE_PASSWORD</code> in
<code>.Renviron</code>, it will be overwritten, so you are safe to run
this function multiple times.</li>
<li>It adds <code>.Renviron</code> into <code>.gitignore</code> to avoid
it being pushed to GitHub thus keeps your password safe. If you run
multiple times, <code>.Renviron</code> will appear only once in
<code>.gitignore</code>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="step-1-3-render-your--qmd-file">Step 1-3: Render your <code>.qmd</code> file<a class="anchor" aria-label="anchor" href="#step-1-3-render-your--qmd-file"></a>
</h3>
<p>This is simple: just hit <strong>Render</strong> or
<code>cmd</code>/<code>ctrl</code> + <code>shift</code> + <code>K</code>
(Mac/Win). But the reason why I make this a stand-alone step is that,
WITHOUT rendering your <code>.qmd</code> file, your survey CANNOT be
deployed online.</p>
<p>One more thing… If you fail to deploy locally while you have set
every argument correctly in your <code>db</code> variable, try to define
<code>gssencmode = "disable"</code> in your <code>db</code>
variable:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sd_database.html">sd_database</a></span><span class="op">(</span></span>
<span>  <span class="co"># Other settings...</span></span>
<span>  gssencmode <span class="op">=</span> <span class="st">"disable"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This can help solve your connection problem. The value of
<code>gssencmode</code> is set to <code>"prefer"</code> by default.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-2-supabase-project">Step 2: Supabase Project<a class="anchor" aria-label="anchor" href="#step-2-supabase-project"></a>
</h2>
<p>This is covered in <a href="../doc/database_setup.html">5. Database
Setup</a>. I want to further mention that you don’t need to actively
create any table on your supabase project. In your <code>db</code>
variable of your <code>.qmd</code> file, there is a
<code>table_name</code> argument. Whatever name you define here will
become the table name of your supabase:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sd_database.html">sd_database</a></span><span class="op">(</span></span>
<span>  <span class="co"># Other settings...</span></span>
<span>  table_name <span class="op">=</span> <span class="st">"demo"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the above example, the table name in my supabase project will be
<code>"demo"</code>. If your survey project runs successfully locally
and can have survey data collected in supabase, you are ready for your
online deployment.</p>
</div>
<div class="section level2">
<h2 id="step-3-online-deployment">Step 3: Online Deployment<a class="anchor" aria-label="anchor" href="#step-3-online-deployment"></a>
</h2>
<p>So this is our final step: to deploy your survey online. I’m glad
you’ve made this far! You are almost there!</p>
<p>We’ll use <a href="https://www.shinyapps.io" class="external-link">shinyapps.io</a>. Now
before we start, here are two explanations to clear out your possible
questions:</p>
<ol style="list-style-type: decimal">
<li>
<a href="https://www.shinyapps.io" class="external-link">shinyapps.io</a> can support both
<a href="https://shiny.posit.co/r/getstarted/shiny-basics/lesson1/index.html" class="external-link">Shiny
Apps</a> and <a href="https://quarto.org/docs/dashboards/interactivity/shiny-r.html" class="external-link">Quarto
Shiny Documents</a>. In our case, our survey is considered as a Quarto
Shiny Document.</li>
<li>
<a href="https://quartopub.com" class="external-link">Quarto Pub</a> is also a website
publishing platform. In fact, both Quarto Pub and shinyapps.io are
provided by <a href="https://posit.co" class="external-link">Posit</a>. However, we DON’T use
Quarto Pub for our survey deployment. The core reason is that,
shinyapps.io can make interactive websites, but Quarto Pub only makes
static websites. A survey is apparently an interactive website, so it’s
compatible with shinyapps.io, not Quarto Pub.</li>
</ol>
<p>To start using shinyapps.io, you’ll need to create an account and
follow the basic instructions to set up your sub-domain and authorize
your IDE. See more information <a href="https://docs.posit.co/shinyapps.io/guide/getting_started/" class="external-link">here</a>.</p>
<p>Once you have your account and your sub-domain ready, it’s time to
deploy your survey website.</p>
<p>Make sure you have the <a href="https://rstudio.github.io/rsconnect/" class="external-link">rsconnect</a> R package
installed (You should have done this while you authorize your IDE):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">'rsconnect'</span><span class="op">)</span></span></code></pre></div>
<p>The simplest way is to run this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rsconnect</span><span class="fu">::</span><span class="fu">deployDoc</span><span class="op">(</span><span class="st">"your_survey.qmd"</span><span class="op">)</span></span></code></pre></div>
<p>The URL of this page will be your domain followed by
<code>/your_survey</code>, which means the name of your
<code>.qmd</code> file will be in the URL. The tab name of the HTML page
is also <code>your_survey</code>. Better give a good name to your
<code>.qmd</code> file.</p>
<p><strong>Again, you’ll need to firstly render locally and make sure it
works properly. Otherwise, this deployment will fail.</strong></p>
<p>If you want to define a different tab name for your survey page,
run:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rsconnect</span><span class="fu">::</span><span class="fu">deployDoc</span><span class="op">(</span></span>
<span>  doc <span class="op">=</span> <span class="st">"your_survey.qmd"</span>,</span>
<span>  appName <span class="op">=</span> <span class="st">"Survey Name"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now you should have your survey site deployed. The survey is now
served on <strong>shinyapps.io</strong>, with its data stored on
<strong>supabase</strong>. Congratulations!</p>
<p>Further explanation (with my personal interpretation) of the
deployment functions:</p>
<p>In rsconnect, there are two functions that can be used for
deployment: <code>deployApp()</code> and <code>deployDoc()</code>. They
serve different purposes and should NOT be mix-used.</p>
<ol style="list-style-type: decimal">
<li>
<code>deployApp()</code> is used to deploy a Shiny App. It doesn’t
work for <code>.qmd</code>, but works for Shiny App and
<code>.rmd</code>, and it accepts multiple files.</li>
<li>
<code>deployDoc()</code> is used to deploy a Quarto Shiny Document.
It works for a single file and tries to “automatically discover
dependencies” (direct paste from <a href="https://rstudio.github.io/rsconnect/reference/deployDoc.html" class="external-link">official
instructions</a>).</li>
<li>Since our survey is a Quarto Shiny Document, we use
<code>deployDoc()</code>.</li>
</ol>
<blockquote>
<p>I guess <code>deployDoc()</code> is a newer function that
specifically works for <code>.qmd</code>. I have a feeling that this
function is specifically made for <code>.qmd</code> to match the fact of
“single document” and “dependencies”. In our case,
<code>deployDoc()</code> is a perfect match.</p>
</blockquote>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Paul Helveston, Pingfan Hu, Bogdan Bunea.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
